{% if user.is_authenticated %}
    <h1>Калькулятор</h1>
    <form method="post" action="{% url 'calculate' %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Вычислить</button>
    </form>

    <h2>История вычислений</h2>
    <ul>
        {% for calc in history %}
            <li>{{ calc.expression }} = {{ calc.result }} ({{ calc.created_at }})</li>
        {% endfor %}
    </ul>
    <a href="{% url 'logout' %}">Выйти</a>
{% else %}
    <h1>Добро пожаловать!</h1>
    <a href="{% url 'login' %}">Войти</a> | 
    <a href="{% url 'register' %}">Зарегистрироваться</a>
{% endif %}